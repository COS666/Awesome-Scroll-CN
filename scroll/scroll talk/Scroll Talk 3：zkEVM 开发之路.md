1. 前奏: Endless Night (35')
2. Scroll Talk介绍 (6' 入场)
	1. Scroll Talk 是 Scroll CN 主理的一档播客节目。我们会通过不同的形式，和 Scroll 团队，Scroll 生态项目方对话，帮助大家更了解 Scroll。
3. 当期节目大概介绍
	1. 本期节目，我们请到了Scroll的联合创始人Haichen Shen，和他一起来聊聊关于Scroll的开发，背后的工程师团队，Haichen老师也分享了自己在AI和ZK两个赛道的经验和见解。


# 采访稿

## 开场
F.F：首先非常感谢Haichen老师的到来，Haichen老师是Scroll的联创也是工程团队的Lead，我们可能不经常看到Haichen老师出现在活动中，但一般每次出现，都会给我们带来很多惊喜的进展。所以大家对Haichen老师可能相对了解的没有那么多，我们先请Haichen老师来做下自我介绍（Haichen可以多介绍一些关于自己）
Haichen：大家好，我是Haichen，然后Scroll是联合创始人之一，在Score内部我主要是负责工程团队，然带领一些工程师去开发zkEVM的电路以及Scroll的节点，包括Sequencer，桥合约,还有一些别的一些事情。然后再之前的话，在做Scroll之前，我在Amazon的AWS做了几年，当时主要是负责开发一个叫AI Compiler，就是TVM，这其实也是一个开源的一个项目，这个项目主要的目的是，把一个训练完的深度学习的模型或者别的非深度学习的一些传统的Machine Learning的模型，讲其训练完之后，如何在做推理的时候能做更多的优化，针对不同的硬件，比如说平常熟悉的GPU，CPU，可能还有些手机端的一些内容，包括一些AI加速硬件做一些优化。在加入AWS之前，我是在华盛顿大学获得了PhD的学位。当时我的背景主要是更多是做系统，做一些机器学习系统的优化，然后加上一些编译器的技术，使得机器学习和深度学习的一些模型可以做得更快，做得更具扩展性，也可能会用一些分布式的系统，去做一些推理的优化。再之前的话，我是在清华本科，也是计算机系。这大概是我的个人介绍

F.F：谢谢 Haichen 老师，我们刚刚听到 Haichen 老师之前的非常多的经验是在AI，从事机器学习的相关工作。我相信 Haichen 老师在机器学习上面应该是沉淀了非常的久，然后我们可能会很好奇吸引你就是来到加密货币领域，然后在 Scroll 这个项目上进行创业。
Haichen：其实之前的话，就是我对加密货币也是有些了解，在我们PhD期间的时候，也对比特币包括当时出来的以太坊也做过一些了解。然后当时甚至我们有跟一些别的一些PhD的学生有聊过说，看看能不能做一些别的东西，可以做的不太一样。但当时主要还是出于兴趣爱好去做这件事情，然后去了解一下，并没有实际投入太多的精力实际去做这个事情。所以还是继续做回那种机器学习相关的系统。是什么契机又重新回到加密货币呢。因为当时就是通过一些共同朋友介绍认识了Ye和Sandy，然后主要是 Ye 当时对我科普一下关于就是ZK电路的证明系统的一些新技术，对我那个触动比较大，我对零知识证明，之前稍微有所了解，但只是停留在那种概念层面。经过他跟我科普了一下实际的背后的算法以及数学的一些实现的时候，我觉得这个设计是非常精巧的，它可以把一些大量的运算然后压缩成为一个多项式的表达式，做一些非常小的一些检测去测试，就可以完全验证说这个计算被正确运行，背后有很多数学知识，使得他可以如何把这个计算表达成一个多项式的表达式。我觉得他的整体构造非常精巧，然后另外一点就是我觉得ZK一开始的时候其实没有可行，他有时候会有非常大的额外的开销，然后导致说你很难把一个大量的计算，就像真的压缩成一个比较好的一个零知识证明电路。但由于最近几年有很多新的数学理论提出，包括比如说从以前的R1CS推广到Plonk，包括加了一些Lookup的这种新技术，使得他可以把一些比较大的一些电路实际真的压缩成一个系统，并且不会说这个他的生成证明的时间不会太长，导致他完全无法使用。所以这一点可以解决很多复杂的系统问题对我来说很有吸引力，我觉得这是一个很有前景的一个方向，所以让我非常想在这个领域去进行涉猎，然后另外一个方面就是说零知识证明在什么方面可以使用上，其实加密货币是一个非常好的一个使用场景。因为首先加密货币，它需要有非常非常高的这种安全性的要求，所以对零知识证明会有一定需求。我们可以把以太坊或者别的一些加密货币理解成一大巨大的共同状态机，就有很多分布式的节点，大家共同参与来维护的一个状态机，所以它的开销是会比较大的，这就使得这个零知识证明的压缩计算的这个效率，或者说这个功能可以非常好地应用到加密货币这个领域上去。 这是一个非常自然的一个方法，就是说我们会使用想到用零知识证明来压缩计算来降低开销，然后对于加密货币这边来说其实过了很多年以后生态开发有了很多的进展，不单单只是从以前的比特币大家只是做一些简单的这种支付，转账的功能。包括以太坊这边有很多的创新，包括一些DeFi，NFT这种非常新的应用程序，让我觉得这个领域是个非常有前景，有很多实际使用场景而不是简单的大家就是做一些转账，然后挖挖比特币之类。
就结合这几个方面，所以我觉得这个结合对我来说是非常有吸引力的，所以这是为什么我就从AI的这个机器学习领域就转到了加密货币这边。

F.F：明白，谢谢 Haichen 老师，就是我之前最开始看到零知识证明这项技术的时候，也有简单了解过，发现它确实做了一些非常精巧的一些取舍，链上的证明开销会非常的小，然后把大量的这种计算代价都转移到了链下。AI的话最近非常火，ZK的话是目前应该说是加密领域最有挑战性的一个赛道。然后就想问一下 Haichen 老师你是怎么看待这两项技术的，一个是ZK，一个是AI。两个都非常热门，AI现在有非常多的人流转到ZK这边，然后ChatGPT横空出世的时候，又有一些人才回流了。因为Haichen老师应该对两个技术应该都非常有研究，也非常有深入地做过实践。就想问一下 Haichen 老师，你觉得这两项技术的这个价值点各自在哪里
Haichen：首先AI这方面，在ChatGPT当时刚出现的时候，我觉得我也很震惊，觉得AI技术取得了一个大的突破，虽然它可能从GPT之前已经做了很多这种模型的基础研究，但是我觉得真正把它做到非常大规模，发现这个AI可以做很多很多事情。以前大家觉得机器可能没法做，然后ChatGPT突然达成了，我觉得对大家冲击还是非常大的，所以我也可以理解说很多人觉得AI会有一个非常大的前景，我个人也非常同意，AI这个地方领域还有很多发展，大家可能还会有更多的一些新的模型，以后也会做更多的进展。但我个人觉得说ZK这个领域也是一个非常有前景的一个领域，AI这边的话，虽然它可以解决很多问题，带来便利性，可以提升工作效率。但是我觉得也会带来很多问题，比如说真实性的问题，比如说大家可能会很容易的产生一些假的文字有图片之类，这里会带来很多问题，所以我觉得如何解决这个问题也会变成一个比较大的一个话题。将来当大家会来越来越多发现这个数据上很多问题是由AI造成的话，就会想要相应的解决方案。我个人觉得ZK就是一个有潜力的解决方案。因为ZK可以隐藏原始的输入，获得隐私上的效率，另外一点就是它可以去验证这个证明背后的计算正确性，包括验证输出是由某个模型生成。
这样的话可能可以结合AI和ZK，现在已经有不少团队在做这方面的研究，如何结合ZK和AI做一些事情来解决成AI的一些弊端。


F.F：是这样，我们有看到经常有人提到 AI 其实现在已经出现了一些问题，包括您刚才讲的数据的真实性，这里不仅是喂进去的这个数据是不是真实的，还有出来的这些数据是不是真实的，这是一方面。然后另一方面还会有人会担心这些巨头垄断了数据的所有权后，可能会带来个人隐私的一些侵犯。相对来说ZK的话，确实可以对它进行一定的互补，从公平方面解决AI带来的一些弊端。然后ZK和AI应该都是属于计算密集型的一些工作，我们想问一下就是Haichen老师，你觉得从你之前从机器学习然后切换到现在ZK，你觉得最大的挑战是什么，然后就工程技术工程上来说，你觉得哪一个实现难度会更高一些。另外这两项技术刚刚你也提到就是可能偏互补的关系，那有没有一些可能共通的地方。
Haichen：首先从机器学习切换到ZK，我觉得一个比较大的挑战是对程序的一个认知。就是说写ZK电路的时候，它和一些普通程序不太一样。然后并且机器学习其实他已经发展了许多年，所以他有一些比较完善的一些框架，像以前有许多python的库，然后后面有tensorflow，这些工具可以比较方便地去实现一些新的模型，ZK这方面的话其实他的工具链还不如机器学习那么完善，并且你切换到ZK的话，你很多时候需要对ZK底层有所了解，然后才能写出一个比较优化的一个电路的设计。这方面的话我觉得从设计角度来说，其实我觉得ZK可能会更大一些。当然机器学习我觉得也有很多功能上的难度，但很多时候可能大家更多是算法上如何来训练这个模型，或者设计这个模型架构使得这个最后能产生的效果最好。
然后技术上来说其实我觉得两项的确有比较多的共同点，他们选择的都是计算密集型的操作，所以很多时候都会用到GPU的来做加速。像我们自己的话，我们也做了一个GPU加速的一个证明者，来加速零知识证明生成的计算过程。
但是我觉得AI来说，由于它模型不断地增大，所以它的技术挑战慢慢从从单个GPU的优化扩展到了就是如何跨多GPU，或者整个集群的一个优化，更多像超级计算机那种优化事情。然后ZK这边可能还更多的建立在单个GPU的优化上，因为更多的时候单个计算量没有那么大，并且它的经常说它的数据传输会是它的主要瓶颈，所以不太会用到多GPU的协作来去做优化。
然后还有一点就是，它们在技术上可能在慢慢趋近，首先是ZK这方面它做的计算都是大整数计算，所以它基本上是不会用到浮点数计算的。其实你慢慢看到，AI也在往低精度的浮点数，甚至一些整数来做计算。这方面我发现就是，以后GPU的设计来说，它可能会更多的考虑做整数上的优化，而不是做浮点数计算的这种优化。


F.F：明白，谢谢 Haichen 老师。你刚刚也提到现在GPU的很多设计就是，要么就是适应ZK，要么就是适应AI，然后去对它设计上去做一些改进。然后你刚刚也提到ZK的话相对来说会比较早期一些，所以它的工具链会比较少。像AI的话，它可能发展的确实会比ZK会早一些，所以工具量都比较成熟，我们也能看到AI其实已经出现了非常多的应用层面的一些创新。但ZK的话可能还停留在一些技术底层架构上的一些设计，然后包括证明系统都会有推陈出新出来。我之前有看到Worldcoin 他们是用了ZKML的技术，就是把ZK和ML都给结合在一起了，它其中有一个分类是按照三个技术特点去划分，分别是隐私，计算正确性，还有启发式优化。ZKML相当于是结合了这三个特性的一个技术，从这个角度看的话，我觉得说ZKML的技术特性的话，应该是既能保护隐私，又能确保计算正确性，然后还能像AI一样实现推理的一些功能。Haichen 老师你是怎么看待他们这个分类的视角。
![](./img/Scroll%20Talk#3_zkml.png)
Haichen：首先我觉得他们这个韦恩图分类还是很有道理的。它的确是从计算正确性，隐私和启发式优化这三个角度结合会有产生不同的一些技术。我个人觉得这ZKML还是一个相对比较早期的一个技术，包括就我了解到大家做的ZKML的模型，它很多时候基本上还是只能支持到一些比较小的模型，就我们知道的一些ImageNet上的一些模型不会特别大，还有像AlexNet，还有MobileNet它们一些比较小的模型可以实现，而且是在整数上的模型。浮点数在ZK 电路里面会比较难以实现，所以大家一般来说会用整数的模型来去把它放在ZK电路里面。
然后ZK其实不太会像普通的计算，你把一个计算输入输进去，然后就会得到输出。对ZK来说，它其实是输入和输出同时都算完以后，把它放到电路里面去验证说这个计算过程是正确。可能实际使用上来说我觉得ZKML可能还会有一段时间的距离。因为首先就是比如大家用AI模型的时候可能现在就已经比较贵了，然后如果你还要再需要就是用ZK再去做一个证明的话，可能这个开销会翻倍者，甚至是5到10倍的这种额外的开销。我觉得很多时候大家可能会暂时还是还不会太使用，除非我们以后觉得硬件的优化和技术的优化可以把这个10倍后的开销做到很低的话，那我觉得可以慢慢可以进入实际使用的状态。
但是我觉得这个方向的研究是会很有用的，将来一定会有一些结合的技术，在一些对安全性要求非常高的一些使用场景来说，使用结合ZK和ML结合的技术在一起，会形成一个新的领域。


F.F：谢谢 Haichen 老师，您刚刚说其实ZKML还是比较早期，可能比ZK和ML这两个各自领域都还要早期，然后我们也看到实际上在用这项技术的可能也不太多，就只有Worldcoin这种确实有实际用例在使用。那我想问一下Haichen老师可能ZKML用例比较少，但AI现在大家已经非常有感知了，已经对我们现实生活中有所改变，不管是生产效率上来，还是包括生活上的一些辅助功能。那ZK这个技术，你觉得它未来会对链上还有链下带来那些改变，能让人有明显感受的应用会出现吗。
Haichen：其实很多时候ZK已经在链上用到，比如说以前的Tornado Cash，还有一些这种隐私投票，像Semaphore。接下来的话ZK就是会用到二层的Rollup上面，这里有很多zkEVM的实现，会对整个以太坊来说有比较大的一些改变，会降低整个以太坊的这个上面的交易手续费不会损失任何以太坊安全性的保证。然后大家还有考虑在做的就是用ZK来做游戏，因为会有一些非对称游戏需要信息被隐藏，这时候ZK就会被使用到，一些完全纯链上的游戏也会用到ZK的一些技术。
然后链下的世界的话，其实我觉得也会有很多新的程序，包括ZKML我觉得在有些情况下已经可以被使用，比如说之前Dan Boneh曾经提到过，大家经常会修图，那然后如何证明这个修改的图片的真实性，就是它的确是由某个人拍出来的，而不是屏空捏到出来的。它可以通过ZK的电路，把所有对原始图片的一些修改，然后配合上相机拍照当时GPS所在位置，它可以有这么一个证明。这样的话就可以保证这个图片的真实性。从这方面看，ZKML我觉得将来是会有使用场景的。

F.F：明白，就像 Haichen 老师您提到的，链上大家已经有一些应用已经在使用，然后链下可能未来也会有一些应用到现实生活。包括我也有看到就是有一些项目方，通过ZK然后打通链上链下的关系。也有像Axiom这样的项目方，在做预言机相关的事情。所以我们也非常期待未来ZK能出现在我们的生活当中，给我们带来生活上的一些便利。



## 工程团队
F.F：谢谢 Haichen 老师上面给我们分享了那么多有深度的见解，不仅关于ZK，还有关于AI。接下来我们就是想回到 Haichen 老师现在在做的一些事情上，就是Scroll 的测试网的话其实就是在目前的L2项目方中，不管是说性能还是稳定性上都是比较靠谱的。所以我相信Scroll的工程团队，不管是基础设施团队也好，还是ZK团队也好，应该都是业界非常厉害的工程师团队。那能不能让 Haichen 老师给我们大概介绍下现在Scroll工程团队的大概情况，包括他们的日常工作流是如何的
Haichen：我们的工程团队现在大概有20到30个人，然后有一半的工程师是做ZK方向，就是ZK电路，zkEVM的开发。然后剩下一部分是会去做基础设施，桥还有合约的开发。我们的团队是非常分布式的，就工程团队来说，跨越了三个不同的时区，有欧洲的，美国的然后还有中国，亚洲别的地区的一些团队在开发。整体来说，因为我们的团队工程师基本都会比较厉害，大家基本上没有一个集中的一个办公室，都是在家办公或者远程办公。我们每周经常也会有些同步会，比如说就是我们每个团队基本上每周大概有两到三个同步会，让大家同各种的进度，遇到的问题，或者一些技术上的设计上。我们通常是在线上用Slack，来让大家一起来讨论问题。这样的话在不影响大家效率的情况下，然后又能尽可能的做到大家能互相了解，有什么问题可以互相帮忙一起参考。

F.F：谢谢 Haichen 老师，就刚刚你也提到了 Scroll 工程师团队里面大多数是一些自主性比较强，并且自身工程能力也比较强的一些工程师。所以说大家可能就是能把自己的工作做好，再协调解决一些沟通的问题。然后20到30个人的团队据我了解，在区块链行业里面也算是比较大的工程团队了。我想问一下 Haichen 老师是怎么吸引到这些工程师加入了 Scroll。另外因为像ZK电路的工程师，在业内会更稀缺一些， Scroll 是怎么吸引到这么多优秀的工程师的？
Haichen：我觉得一个是说大家会比较相信，我们的整个路线图，就是我们会想要通过zkEVM去给以太坊扩容，达到一个比较好的开发者体验，我们当初选择做zkEVM的一个出发点，就是说想尽可能减少开发者的迁移成本。我觉得大家会比较相信我们的技术路线和以后的一些发展方向。我觉得这个是一个方向。然后第二个呢，我觉得是说，之前张烨也算是就是零知识证明这边的一个大牛，包括我们工程师团队里面有些比较厉害的大牛，大家都会比较相信。然后跟大家聊完之后，大家会非常喜欢我们整体团队的一个氛围，和开发者的一个环境。然后他们有些会觉得说可以通过加入我们团队开发学到很多东西。结合这些，他们会比较愿意跟我们聊，然后聊完之后，他们会得到一个比较好的反馈，所以我们才可以招到这样的一个团队

F.F：明白，谢谢 Haichen 老师，这可能是个良心循环，本身Scroll价值观和文化可能吸引了优秀的人才进来，然后人才的积累，又吸引了更多人才，才把 Scroll 这个团队从0到1搭建出来。刚才 Haichen 老师你也提到，Scroll 和以太坊价值观比较接近。然后我们也了解到，Scroll 会和以太坊基金会的PSE团队，一起在构建以太坊的最终ZK化的一个版本。然后我们很好奇其中一些合作的细节，比方说这种人员的协调分配，然后代码库之间的关联和协作是怎么样的。因为以太坊的zkEVM应该算是一个Type1，可能跟Scroll在构建的这个类型还是有一些不一样？
Haichen：这个的话其实最开始时候，我们创立Scroll这个团队的时候，张烨和我们一起讨论写了一个小的提案，就是我们想搭建这个zkEVM，然后使用zkEVM来扩容以太坊的路线。然后当时张烨就分享给了以太坊基金会PSE团队的Team Lead，就是Barry Whitehat。对Scroll了解的朋友可能知道这个故事。当时我们分享这个提案的时候，Barry就回复我们说他们正好也想组织一个团队来开发这个zkEVM，然后邀请我们说想不想一起和他们开发。当时我们觉得这个非常好的机会，首先我们目的就是为了扩容以太坊，然后我们跟以太坊基金会的人一起合作开发，这是一个非常好的机遇，也会和以太坊达成一个非常好的一个同步和合作的关系。他们会说，我们想要做开源开发。
这对我们来说完全没有问题，所以一开始完全是在开源的基础上，开发这个zkEVM的电路。同时我们也有很好的一些机会，可以和以太坊基金会的PSE团队里面一些比较厉害的工程师和ZK的专家一起合作，讨论里面的细节，例如如何设计这个电路整体的架构。
我们当时还有很多这种讨论，大家一起讨论会带来很多的帮助。然后之后的协作方面来说，我们一开始基本上就完全把我们的贡献提到了以太坊基金会PSE那边的开源库。大概可以看到，里面将近一半的代码是由我们 Scroll 的团队去贡献的。协调方面的话，因为zkEVM的设计都比较模块化，我们可以把以太坊虚拟机里面的不同opcode分成不同模块，使得大家可以分工去开发。当时每周我们会有一个同步会，去讨论一下，然后大家分布式地去开发，这是比较早期的时候。到了中后期，我们这边会对二层链做一些修改，包括之前提到他们他们会想要做一个Tpye1的版本，我们更多会去对二层做更多的优化，使得零知识证明的额外开销会变得更小一些。所以我们技术层面会有些不太一样，所以慢慢我们就维护了一个自己版本的Repo。然后我们会先在我们这个代码库里面进行开发，等我们这边开发完成以后，我们会定期把一些我们自己开发的一些进度，如果是跟PSE他们的技术路线符合的，我们就会把这个新的功能做一个PR，然后提交到他们的代码库里面去。我们其实还是会保持每周的一次同步会，跟他们同步的进度，我们有些什么优化的想法都会跟他们分享，然后他们会决定说是否要采纳我们这个优化路线，有些时候我们的优化可能他们不一定会使用，但更多时候从电路设计上来说，我们其实完全从同一个版本开发，所以还是会有很多我们的优化，包括我们找到的一些Bug，我们都会及时提交，来维护两个版本都可以跑起来。

F.F：明白，谢谢 Haichen 老师。我觉得这种开源，模块化的这种协作模式特别好，然后也会有定期的同步，包括您刚刚讲的Barry Whitehat 论坛上的那个帖子，我之前也有看到过。我觉得Scroll 和以太坊这种不管是价值观，还是工程上来说都是非常一致的，保持了一致的步调。这对于未来L2的扩容，我相信也是非常有帮助。除了PSE团队，我们也经常就看到 Scroll 和其他的ZK项目方会有比较多的交流，就包括Scroll有做一个ZK系列，会经常邀请到不同的ZK项目方来做交流，分享他们的一些技术或者他们的项目。我们也比较好奇就是 Scroll 和这些团队的合作一般会是以什么样的形式
Haichen：我们的确是有在组织一个ZK的一个分享会，每周会邀请一些别的ZK团队的一些专家过来分享一下他们最新的一些技术，包括也会找到一些高校研究机构的一些教授或者学生过来做一些分享，这是一方面。我们其实也会和很多ZK团队定期交流，包括我们之前也会发现别的ZK团队，他们有一些bug，然后会及时跟他们沟通去说，让他们去修复。然后也会有一些路线上有什么新的优化。我们也会参与一些ZK的线下会议，然后我们会去参与分享，或者是去听，去参与沟通。比如最近比较火的说基于folding的ZK证明模块的优化，我们也都会参与。
除了这些之外，我们也会跟别的团队做一些代码上的合作。主要是基于 Halo2 的生态项目，因为 Halo2 这个证明的这个框架现在做的比较成熟，上面有很多有用的资源，比如说zkEVM里面的很多开发电路大家可以拿去使用。所以我们会有别的一些团队选择采用 Halo2 的团队有一些沟通交流，甚至合作。就之前提到的Axiom，我们他们就有合作，一起开发聚合电路。有一些别的团队可能使用 Halo2 来开发会遇到一些问题，也会过来和我们一起讨论，然后我们会给一些建议。其实可以看到，我们和很多ZK的团队有比较密切的交流。

F.F：好的，谢谢 Haichen 老师。我觉得这种合作的氛围真的特别好。因为本身ZK这个电路包括他的一些代码库，还是需要让更多人看到。因为很多可能会有一些bug这样，让更多的工程师看到了，会让这个代码库会更稳定，未来上线的版本也会更好。包括刚刚您提到 Halo2 ，其实这里面已经有形成了一个生态，感觉有很多项目方他们都会用这个 Halo2 证明系统，去实现他们的一些功能。在这个模块上最后想问一下 Haichen 老师，因为大多数的工程师会比较低调，他们可能会更多的在写代码，钻研技术。我们社区里面有非常多的一些刚入门的一些工程师，他们就比较想接触ZK这个领域，他们可能会想关注一些工程师。然后 Haichen 老师，你有没有什么推荐的工程师，除了您之外，我们社区的开发者可以通过他们的Github等等能学到更多的东西，然后也可以跟进ZK的最新技术进展
Haichen：其实从Github来说，我觉得像我们团队里面的Zhuo Zhang，还有Kunxian，他们是都是非常厉害的工程师，在ZK方面有非常多的想法，还有一些写电路上的一些建议优化，他们应该都有推特但可能不是那么活跃，我觉得可能会关注他们的Github会更好一些。
Zhuo Zhang: https://github.com/lispc
Kunxian Xia: https://github.com/kunxian-xia

## zkEVM
F.F：好的，谢谢 Haichen 老师给我们分享了很多关于 Scroll 背后团队的一些情况。接下来我们就确实想更深入的了解聊一下我们这次播客的核心话题 zkEVM 开发。Scroll 应该是已经开发了 zkEVM 有近两年，Scroll 之前有博客文章介绍，但其实已经是去年了，我们经常在推特上看到 Scroll 的一些架构更新，其中是不是已经有发生了一些变化，能不能请 Haichen 老师给我们介绍一下 Scroll 最新的这个 zkEVM 架构。
Haichen：首先来说我们zkEVM的电路整体架构没有太多改动，很多时候做了一些细节的一些微调，包括加入更多的预编译合约的一些电路，使得我们跟以太坊EVM的兼容性会变得越来越高，这个是一个主要的大改动。另外我们做了一些优化，比如说我们读写EVM内存的问题，我们是给每个字节可以做一个读写的地址，后来发现说有些电路会做很多大量以太坊EVM里面的这个内存的读写，导致电路使用开销过大。后来我们就做一些优化，使得把它从每次读取一个字节变成每次读取一个32个字节，因为很多情况他们读的是一个32 字节，或者说U256的类型。这样的话和他们栈类型是匹配的，我们做的这个优化可以在电路里面支持更多的内存的读写。然后还有一个比较大的改动，是说我们可能做了更多层的证明聚合，之前我们考虑电路的大小可能做一层聚合就足够了，但是我们之后发现了，我们之后想说把链上证明的开销降低，所以我们做了更多层的电路压缩和聚合。如果听众不太了解什么是聚合电路，我们可以简单介绍下，可以比较容易理解的是，就像你写了一个编译器它自己可以编译自己，就这么一个感觉。那等于是我们写了一个电路，它是可以验证别的电路生成的证明。这样的话，聚合电路就可以把一个原本比较大的电路，一些非常复杂的操作，先在电路里面验证过以后，最后链上需要验证的一个开销会变得更小。然后聚合电路也有一个功能，就是它可以聚合多个相同电路证明，这样的话我们就可以从验证每个电路证明，变成每20个或者每50个电路才需要去验证，这样的话就可以极大地降低了链上的证明开销，同时就降低我们在二层上面的交易费用，上面是一些在zkEVM电路上的一些最新的架构更新。
然后对于基础设施方面的话，我们做了一个完全无需许可的一个跨链桥，就之前我们的设计可能是会依赖于一个第三方的中继器，来传递从Layer 1和Layer 2的消息。这个的一个缺点是说，以后你可能需要相信这个中继器是诚实的一个节点，它可以把这个消息在Layer 1和Layer 2之间诚实地把它传输过来。然后我们改了一个架构，以后要求是由排序器来把Layer1的上面那些交易和消息，加入到Layer2的交易池里面去，并且这个中继的过程会被零知识证明的电路来认证，所以使得这个排序器是没有办法自己去产生一个假的交易，然后把一层链的一些消息加入到二层链的交易池当中去。做了这么优化后，我们的桥安全性会变得更高，以后也不需要相信某个中心节点去做这个事情，也会更方便以后我们去分布式地扩展到我们的整个链，变成完全分布式的一个链，符合我们未来的技术路线

F.F：谢谢 Haichen 老师，就刚刚您提到的是我之前没有想到的一个点，在排序器包括中继器这个做了一些ZK化，我觉得这是非常有意思的一个点，相信未来可能这个系统的稳定会有比较大的提升。然后刚才您提到相对之前的架构变化，主要在三个方面，一个是预编译方面合约的改进，第二个就是内存读写上面的升级，第三个就是您最后提到的多层聚合证明，这个我理解就是用ZK来证明ZK，有点像套娃。然后如果说大家对Scroll 本身架构不太了解的话，Scroll 之前有两篇文章，我们中文社区有发，分别是《以太坊原生zkEVM Rollup介绍》，《Scroll的架构概览》。这两篇可以让大家对Scroll有一个直观的感受，然后结合 Haichen 老师今天所讲的最新的架构更新，应该就能比较容易理解 Scroll 现在的整个的技术架构。
Haichen：这里另外提一下，我最近准备在写一篇博客，介绍我们的架构。之后发出来以后，大家后面也可以看下中文翻译版本，关注一下！

F.F：好嘞，那就我们期待 Haichen 老师未来的这篇博客。然后过去两年zkEVM的这个开发非常的快，然后也有非常大的进步，不管是说证明系统上的一些创新，还是架构方面的一些创新。但我还是认为，对于一个工程团队来说，来实现zkVEM是不是挑战上还是非常大。可能对于传统公司比方说像Visa，或者说Web2的一些其他公司，更近一些可能是Web3的一些项目方协议，他们如果说想用应用zkVEM，是不是工程上还是会有比较大的难点
Haichen：这个问题分两块吧，一个是开发zkVEM，一个是应用。我觉得开发上来说，大家还是会觉得现在ZK的人才有些稀缺，所以可能要找到一些好的ZK的开发工程师，难度会比较大。但是我觉得这个在慢慢改善，因为有越来越多的线上的教学的视频，以及大家开发的一些框架会变得越来越成熟，然后降低这个开发成本和壁垒，这些已经在有很大的改进，所以我觉得慢慢来说，开发零知识证明会变得越来越容易上手，越来越方便。从应用角度来说，如果想要应用zkEVM电路的话，我们会期待的慢慢会降低这个难度，变成一个非常开源的工程，大家如果想要使用的话，都可以拿来用，毕竟我们的代码都是开源的。之后我们可能要做一些更多的工作，像脚本还有文档上的优化，让大家可以比较方便得通过我们的代码库来使用这个zkEVM。当然我觉得难点在于说，如果大家想要去对zkEVM做一些定制化的东西的话，虽然我们做的比较模块化，所以很多时候我们的代码会比较容易去理解。难点在于说，如果你修改了一些zkEVM的电路，定制化了以后怎么能保障安全性。因为很多时候你可能修改一下后，没有意识到很多地方它的这个限制和关联系。所以可能你修改一部分以后，会导致这个电路出现一些漏洞。

F.F：好的，谢谢 Haichen 老师。因为刚刚你也提到了，Scroll 现在的整个开发框架偏模块化。我们最近有看到比方说OP 他们经常会提到一个 Stack 的概念，不管是Arbitrum还是Optimism，他们也提到了模块化的方案，可以让大家更方便地部署Rollup。那有没有可能zkEVM这边也未来会有一个模块化的框架出来，可以让大家非常方便的定制自己的Rollup。
Haichen：我们是会往这个方向去推进，使得整个设计变得更加模块化，比较容易替换。但主要一个缺点就是，像OP他们整个模块化来说，他们可以说只要把这个排序器里面的某些东西给替换成别的东西，就比较容易做。但对于 ZK 来说，如果在排序起那边有任何改动的话，你在电路里面也同样需要增加改动的证明，这个是一个难点，就是我们没有办法做到完全模块化，因为证明的电路是根据执行层来定制的。我觉得我们可以做的一些模块化可能更多是 DA 数据层，可以让大家可以选择使用不同的数据层的存储，不一定是以太坊。
电路方面可以模块化的，比如说对于单个电路的开发，像 Keccak 哈希做一个单独的模块，大家可以拿出去使用，到别的电路里面去做集成

F.F：明白，就是ZK的模块化和简单 OP Stack 的模块化还不太一样，里面可能会涉及到证明者和排序器共同协调的问题，确实比较复杂。然后 Scroll 现在做的zkEVM的话，按照原先广泛的定义，Scroll 的 zkEVM应该是Type2的zkEVM，但是也有人会认为你们在做的是Type2.5的zkEVM。（这里解释下Type 2类型的zkEVM力求实现完全EVM等效，但不是完全以太坊等效。也就是说，它们“从内部看”与以太坊一模一样，但它们在外部有一些差异，特别是在数据结构方面，如块结构和状态树。Type 2.5是指除gas费外的EVM等效。Type 3类型的zkEVM可能会删除一些在zkEVM中特别难以实现的特性。预编译通常处于最高的优先级；此外，Type 3类型的zkEVM，有时在处理合约代码、内存或堆栈的方式上也存在细微差别）。然后我们都知道开发者非常关心Gas成本，但因为zkEVM本身因为zk证明生成的成本不一样，如果同比例映射，那Gas定价势必要更改，同zk证明生成成本保持一致。想问下Haichen 老师现在是怎么做取舍的，现在的Gas定价和预编译这方面是如何设计的？
Haichen：对，首先我个人其实觉得说 Vitalik 对于 zkEVM 的分类，也不是特别好的一个分类，根据 Gas Cost 来决定分类不是特别合理的一个事情。因为本来零知识证明的电路，它的开销就是会不太一样，可能会以一些别的标准来分类2和2.5会更合理一些。然后我们现在其实会更接近于Type2的一个类型，因为我们一开始考虑修改一些操作码和预编译合约的一些Gas成本，主要是为了防止可能的攻击，这是一个主要原因，因为担心有人调用Gas成本比较低，但电路里开销比较大的操作。不过，我们暂时来说还是保留了原本以太坊的 Gas 模型，没有去做一些修改，一个主要原因是因为我们会意识到就是现在zk有一些新的技术，包括基于folding的技术栈，使得我们将来很有可能可以把这些非常复杂的计算，压缩到比较低的可控成本，不会被用来作为攻击。同时我们可能有一些机制来防止如果有人恶意攻击的话，使得攻击的成本会越来越高。

F.F：好的，谢谢 Haichen 老师。这个非常好，是我之前没有听到过这样的点，可以通过证明系统这块来防止DDoS攻击，可以在取舍上做到一个突破，不需要再去纠结到底是需要去兼容，还是考虑这个证明成本，以后Scroll 的整个Gas 应该就会和以太坊保持完全的一致。然后下一个话题是，从开发者来说，不管是黑客松的参赛者还是Scroll 上的一些开发者，他们对Scroll 的这个开发体验都赞赏有佳，几乎是不需要更改就可以直接部署，大多数就是改一个rpc 就可以了，这个对于扩张生态我相信是非常有帮助的。然后我们也想深入问一下 Haichen 老师关于zk电路方面的问题。因为实际上现在很多的注意力都聚焦在这个证明系统上，像nova或supernova这些，没有太多人在于工程实现上的创新。但我们也有看到，每周更新里面有提到 Scroll 的 zkEVM 其实是有一些工程上的创新，包括把许多复杂度比较高的计算通过查找表解决掉了，Haichen 老师有没有什么可以跟我们分享的 Scroll 在最新工程实现上的一些创新。

Haichen：其实首先我想说一点，我们在 Scroll 上的开发也属于站在巨人肩膀上。有很多是之前大家提出了各种算法和ZK电路上的一些开发优化的经验，我们是在此基础上面做了一些开发，使用了很多它的那些技术，包括就是查找表，这是一个很大的可以把ZK电路降低复杂度的和成本的一个事情，主要原因是之前大家写电路的时候，我们是要想把一个VM放到零知识电路里面去，由于每一步它是执行哪个操作码，哪个指令是不确定的，所以相当于说每一步都要把所有指令的可能性都考虑进去，这就会给整个电路带来很高的成本。但是如果你把相同类型的指令和一些比较大的一些计算把它抽象出来，然后把它变成一个查找表，由一个专门的电路来去实现这个功能单一的计算的话，就会大大的降低这个零知识证明电路的成本和资源的开销。
然后另外的话，我们在开发中做了一些很多控制上的优化，比如说如何降低，尽可能并减少查找表的一些使用，因为使用查找表也是会带来一些额外的开销。
另外一个我们使用的比较多的一个工具叫做RLC(Random Linear Combination)，翻译成中文的话可能是随机线性组合，你可能通过一个随机数，把你的数据通过线性组合，从一个变长的一个数据变成一个单一的数字，因为很多时候你的操作可能是一个变长的操作，但其实零知识证明电路里面特别不适合做那种变长操作，它最好是所有的电路都是一个固定长度。那通过这个RLC这个技术的话，你可以把一个变长的数据变成一个单一的数字，并且没有安全性上的问题，使得你可以很好地做一些电路上的优化。
除此之外，我们还做了很多证明模块的优化，包括把证明模块放到GPU去做计算。还有一个比较大的难题是，我们在生成电路时候需要把一些数据填入到电路里面去，这一块的话后期发现它的占比非常高，之前有段时间占到了高达50%，所以我们可能做了一些并行化电路生成方面的一些优化，使得我们可以把这个证明的时间给压下来，可以优化到两倍以上。


F.F：好的，谢谢 Haichen 老师。我觉得Scroll 这一块真的是做了非常多的努力，不管说是证明者还是说证明系统一些设计的考量，我觉得都是非常有创新的，那 Haichen 老师，你是怎么评价现在 Scroll 和同类型的这些zkEVM竞争对手，包括Polygon zkEVM，Linea，我不知道有没有遗漏。你觉得从工程技术角度来说，怎么样评价他们会更合适一些
Haichen：其实我觉得同类型的zkEVM的竞争对手，他们技术实力都非常强。他们有些团队其实比我们做的时间更久，在早期有过做别的zk电路开发的一些经验。所以其实相对说，他们的经验还有开发时间上都比我们更久。比如说像zkSync，Starkware。但是我觉得Starkware主要的问题，就是这个Cario这个语言开发起来对开发者没有那么友好，然后zkSync由于他的技术路线，虽然也叫zkEVM，我们个人觉得他更像是一个zkVM，因为他使用的是一个编译器，把Solidity 编译到一个不同的虚拟机的指令上去，所以其实对于开发者来说，他会需要找一些额外的插件才能真的去部署他的一个合约到zkSync上去。然后我觉得像 Polygon zkEVM 和 Linea 都是一个很不错的团队。Polygon 和我们使用的一些路线不太一样，在于我们是更原生的支持以太坊的操作码，所以我们把单一的操作码，都直接实现在电路里面去了，使得这个东西更容易做模块化。但是Polygon zkEVM的话，他们是用了底层的一个Assembly 语言，然后他们设置了 Assembly 语言去把 EVM的执行器用这个Assembly 语言重新实现了一遍，我们的排序器其实会跟以太坊兼容性更好，因为我们其实会直接使用以太坊原生的一个排序器，就是Geth，所以我们从兼容性跟别的生态相对说，兼容性会更好一些，所有的RPC方法我们其实全都原生支持。这就是为什么开发者会觉得说，在我们上面开发和在以太坊上开发感受上来说，基本是一样的。然后Linea他们也做得挺不错的，但我觉得从开源性角度来说做的没有那么好，另外他们现在上线主网，他们电路其实都没有做一些非常严格的审计，所以可能会有些更多的潜在的Bug的安全性的一些问题。 然后他们使用的也是一个比较非传统，非常新的一个证明模块，所以个人觉得他们的这个安全性，可能会相对比我们会差一些。


F.F：明白，谢谢 Haichen 老师。即使是同类型的zkEVM，我觉得不同项目方在技术上面，还是做了非常不同的取舍，不管是为了追求性能也好，还是追求兼容性，还是追求安全性也好。我觉得 Scroll 的话是在各个方面都做到了一个非常好的平衡，就包括 Scroll 也做了非常多的审计，然后本身你刚刚也提到，兼容性的话会比其他同类型的要好很多，我目前看到 Scroll Alpha 的测试网的整个网络状态也非常好，但是有些时候也会有交易确认延迟的情况，就想问一下 Haichen 老师，这些交易延迟出现拥堵的时候，是哪里出现了问题，然后 Scroll 团队是怎么样立刻把它给解决掉了。
Haichen： 交易延迟有时候可能是交易量会比较大，我们处理的时候发现了RPC节点内存池过大的一些情况，所以我们之后有做过一些优化，来限制内存池的大小，防止一旦过大的时候，内存这边造成拥堵。另外一个方面，我们也会意识到以太坊的 Goerli 测试网上，它之前 Gas Price 非常不稳定，我记得它到过非常离谱的 1000 Gwei 的价格，这个其实也会对我们当时的测试网造成一些压力。因为我们这边 Layer 2的交易费的价格，是会和Layer 1进行挂钩，毕竟我们会把这个数据需要上链，所以当Layer 1 出现剧烈变动的时候， Layer 2 在提交交易， Gas Price 也会出现变动的话，可能会交易就会不成功，会被拒绝。我们工程上后面做了很多种监控服务，会有及时的预警，我们会有团队的成员去进行观测，即时改善解决

F.F：明白，谢谢 Haichen 老师。确实是那段时间Goerli测试网交易也非常拥堵，从 Layer2 去做一个 Gas 的预估模型会比较困难。然后我们聊聊Scroll的最新进展吧。我们现在能在官推的每周更新上看到的一些更新。然后官网的路线图上似乎有所变动，在主网上线前又多了一个Sepolia Testnet阶段，除此之外，Haichen 老师有什么可以和我们分享的内容吗？
Haichen： 对，我们是打算会把这个测试网做成一个永久测试网，以后有任何新的功能，会使用测试网来测试。主要考虑有两点，一个是以太坊技术路线图上，也会把Goerli测试网关掉，然后只长期维护这个 Sepolia 测试网。所以为了大家可以更长期的可以测试，所以我们会决定说在 Sepolia 上面部署测试网，并且把它变成一个长期维护的一个测试网。然后一个是我们有些最新的变动，以及刚刚我们上面提到的一些性能和整体架构上的优化，会在最新的Sepolia 测试网上进行测试。

F.F：最后的话，想替社区的开发者问一些问题，包括前面我们也聊到了写 zk 电路的话，他要转换一些写程序的思维，不是以前根据输入然后直接输出结果。更多的是是把输入和输出结果同时喂到zk电路里，然后让zk电路来生成证明，这边可能会涉及到写程序的这个思维的变化，除此之外，你觉得对于一个新入门想学习zk电路的开发者来说，他需要做什么样准备，或者说你觉得这方面会有什么样的难点是需要他去攻克的。
Haichen：我觉得首先大家可以去观看一些，我们之前的一些分享，包括对 Halo2 开发的一些技术分享，这样的话可以帮助你更快的上手。或者你可以尝试开发一些小电路，最简单的比如说我们用来举例子的斐波那契电路，让你能够实现这个电路并且能够合法地生成一个证明，把它走通以后对于开发我觉得会比较有帮助。并且从斐波那契电路里面，你可能会看到一些不同的优化方向，可以自己去里面去玩一下。之后我觉得可以从一个非常小的电路，再去做一些比较复杂的事情，包括做一些小的模块，也可以尝试写一些大整数的相关电路，这对于掌握如何开发电路会有很大的一些帮助。
然后我觉得还有一些现在用Halo2开发的一些项目，可以去参考他们电路设计的一些思路。后期主要大的一个难点就是如何做电路的优化，因为实现电路会有很多很多不同的方式，但是不同的方式带来的开销会有很大的不同，如何设计在大整数上面就是做一些数学上的优化，这些都是开发电路上的一些难点

F.F：好的，谢谢 Haichen 老师。如果社区这边的开发者想要入门的话，可以按照 Haichen 老师刚才提供的思路，看一下Scroll这边的ZK相关的一些资料，还有一些Halo 2的一些开源库。然后通过一些小的例子入手，可以快速的入门 ZK。最后就是还有一些开发者，他们已经有了一定的开发经验。Scroll 最新有提到一个开源贡献的计划，我想问一下 Haichen 老师，如果社区开发者想要给Scroll 做开源贡献会是什么样的方式好一些呢?
Haichen：我们内部也会讨论说，因为首先我们的代码都是开源的，所以大家都可以过来看我们的一些代码库。我们也讨论过，将来会把很多issue，包括我们将来想要优化的一些技术路线开放到 Github 上面去，我们也会做一些更好的一些分类，比如说有些比较适合刚入门的人做一些简单的开发任务。大家可以关注我们Github 上的很多issue，然后想要给我们贡献的话，可以从那些issue里面去入手。
另外我们可能会慢慢主持更多的一些开源的讨论会，会把我们内部的一些讨论会开放，邀请更多的开发者过来一起参加，共同参与讨论。我们接下来会想要实现越来越像以太坊那种模式去管理，开放社区来参与一起讨论。并且我们可能会组织一些分享会，给大家分享一下我们现在代码的一些东西，可以让开发者容易上手。


F.F：好的，谢谢 Haichen 老师。非常期待后面 Scroll 在开源社区把更多的开发者聚集起来，共同贡献zkEVM的开发。我相信在这种开源的这种精神，价值观下，Scroll 的zkEVM在未来的话，一定会有一席之地。
最后我们也希望Haichen老师，给Scroll 的zkEVM做一些美好的期许。

Haichen：希望就是我们 Scroll 的 zkEVM 会变成最好的 zkEVM，成为大家默认的zkEVM。然后所有的开发者过来使用我们的主网，测试网。

F.F：好的，谢谢 Haichen 老师。很开心今天能邀请到 Haichen 老师来到我们 Scroll 中文社区，让我们不光对就 Scroll 的zkEVM 有了更多的了解，也对背后的可爱的工程师团队，有了更多了解，然后也祝愿 Scroll 未来主网稳定运行，成为刚才Haichen 老师所说的大家默认的zkEVM。
Haichen：谢谢 F.F，邀请我参加这次播客的分享。



- 参考文章
	- [[1802.04799] TVM: An Automated End-to-End Optimizing Compiler for Deep Learning](https://arxiv.org/abs/1802.04799)




结尾：26‘